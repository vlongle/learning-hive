/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 20}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'recv_data', 'num_coms_per_round': 2, 'num_queries': 10, 'num_data_neighbors': 10, 'num_filter_neighbors': 10, 'scorer': 'cross_entropy', 'query_score_threshold': 0.0, 'shared_memory_size': 100000, 'comm_freq': 1}, 'seed': 0, 'algo': 'monolithic', 'job_name': 'fashionmnist_monolithic_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/recv_results', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-12 00:00:58,492][root][INFO] - Class sequence: [5 0 4 3 4 6 4 3 8 0 1 0 5 9 6 4 9 0 3 0]
[2023-10-12 00:00:58,512][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-12 00:00:58,566][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-12 00:00:58,592][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-12 00:00:58,636][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-12 00:00:58,662][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-12 00:00:58,690][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-12 00:00:58,718][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-12 00:00:58,746][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-12 00:00:58,771][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-12 00:00:58,796][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-12 00:00:58,907][root][INFO] - Class sequence: [4 7 5 7 6 0 3 0 5 0 3 6 2 7 6 7 6 1 0 5]
[2023-10-12 00:00:58,926][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-12 00:00:58,953][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-12 00:00:58,981][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-12 00:00:59,009][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-12 00:00:59,037][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-12 00:00:59,065][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-12 00:00:59,086][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-12 00:00:59,114][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-12 00:00:59,136][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-12 00:00:59,163][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-12 00:00:59,281][root][INFO] - Class sequence: [6 7 7 8 4 1 1 8 6 1 6 4 5 7 8 0 2 3 0 3]
[2023-10-12 00:00:59,298][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-12 00:00:59,328][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-12 00:00:59,355][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-12 00:00:59,375][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-12 00:00:59,400][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-12 00:00:59,426][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-12 00:00:59,454][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-12 00:00:59,480][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-12 00:00:59,508][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-12 00:00:59,532][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-12 00:00:59,644][root][INFO] - Class sequence: [2 8 0 3 7 4 3 4 4 5 9 3 0 6 9 1 3 1 7 9]
[2023-10-12 00:00:59,661][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-12 00:00:59,690][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-12 00:00:59,715][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-12 00:00:59,743][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-12 00:00:59,770][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-12 00:00:59,796][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-12 00:00:59,820][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-12 00:00:59,843][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-12 00:00:59,867][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-12 00:00:59,900][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-12 00:01:00,010][root][INFO] - Class sequence: [0 3 0 2 9 7 0 9 2 1 7 6 8 6 1 8 6 4 9 8]
[2023-10-12 00:01:00,028][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-12 00:01:00,055][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-12 00:01:00,082][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-12 00:01:00,107][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-12 00:01:00,130][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-12 00:01:00,157][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-12 00:01:00,183][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-12 00:01:00,204][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-12 00:01:00,232][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-12 00:01:00,260][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-12 00:01:00,374][root][INFO] - Class sequence: [8 4 6 3 3 1 1 6 4 9 3 2 2 9 6 0 5 9 7 2]
[2023-10-12 00:01:00,393][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-12 00:01:00,427][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-12 00:01:00,452][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-12 00:01:00,476][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-12 00:01:00,505][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-12 00:01:00,528][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-12 00:01:00,555][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-12 00:01:00,582][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-12 00:01:00,605][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-12 00:01:00,633][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-12 00:01:00,745][root][INFO] - Class sequence: [7 5 8 4 6 9 8 3 4 6 1 3 3 1 4 1 9 2 6 2]
[2023-10-12 00:01:00,764][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-12 00:01:00,792][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-12 00:01:00,820][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-12 00:01:00,848][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-12 00:01:00,875][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-12 00:01:00,900][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-12 00:01:00,924][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-12 00:01:00,951][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-12 00:01:00,976][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-12 00:01:01,006][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-12 00:01:01,119][root][INFO] - Class sequence: [5 1 8 3 9 6 5 9 5 0 7 2 7 8 6 1 6 0 0 6]
[2023-10-12 00:01:01,138][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-12 00:01:01,160][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-12 00:01:01,187][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-12 00:01:01,212][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-12 00:01:01,236][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-12 00:01:01,264][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-12 00:01:01,286][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-12 00:01:01,312][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-12 00:01:01,339][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-12 00:01:01,366][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_nocomponents.NoComponentsER'>
[2023-10-12 00:01:01,395][root][INFO] - No. gpus per agent: 0.25
Error executing job with overrides: ['algo=monolithic', 'seed=0', 'parallel=True', 'num_agents=8', 'dataset=fashionmnist', 'dataset.num_trains_per_class=64', 'dataset.num_vals_per_class=50', 'dataset.remap_labels=True', 'dataset.with_replacement=True', 'dataset.num_tasks=10', 'net=mlp', 'net.depth=4', 'num_init_tasks=4', 'net.dropout=0.0', 'train.num_epochs=100', 'train.init_num_epochs=100', 'train.component_update_freq=100', 'train.init_component_update_freq=100', 'train.save_freq=20', 'root_save_dir=experiment_results/recv_results', 'agent.use_contrastive=True', 'agent.memory_size=32', 'sharing_strategy=recv_data', 'agent.batch_size=64', 'train=monolithic', 'job_name=fashionmnist_monolithic_numtrain_64_contrastive']
Traceback (most recent call last):
  File "/home/vlongle/learning-hive/experiments/run.py", line 33, in main
    fleet = FleetCls(graph, cfg.seed, datasets, cfg.sharing_strategy, AgentCls, NetCls=NetCls,
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 253, in __init__
    self.create_agents(seed, datasets, AgentCls, NetCls, LearnerCls,
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 264, in create_agents
    self.agents = [
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 265, in <listcomp>
    AgentCls.options(num_gpus=self.num_gpus_per_agent).remote(node_id, seed, datasets[node_id], NetCls,
AttributeError: type object 'ParallelRecvDataAgent' has no attribute 'options'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
{'algo': ['monolithic'], 'seed': 0, 'parallel': True, 'num_agents': 8, 'dataset': 'fashionmnist', 'dataset.num_trains_per_class': 64, 'dataset.num_vals_per_class': 50, 'dataset.remap_labels': True, 'dataset.with_replacement': True, 'dataset.num_tasks': 10, 'net': 'mlp', 'net.depth': 4, 'num_init_tasks': 4, 'net.dropout': 0.0, 'train.num_epochs': 100, 'train.init_num_epochs': 100, 'train.component_update_freq': 100, 'train.init_component_update_freq': 100, 'train.save_freq': 20, 'root_save_dir': 'experiment_results/recv_results', 'agent.use_contrastive': True, 'agent.memory_size': 32, 'sharing_strategy': 'recv_data', 'agent.batch_size': 64}
No. of experiments: 1
Experiment runs took 0:00:08.270335
