{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 1}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'gradient', 'num_coms_per_round': 1, 'comm_freq': 10, 'mu': 1.0}, 'seed': 1, 'algo': 'modular', 'job_name': 'fashionmnist_modular_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/fedavg/', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-17 21:18:19,540][root][INFO] - Class sequence: [6 4 1 4 5 6 6 2 2 7 9 7 1 6 4 9 8 5 4 1]
[2023-10-17 21:18:19,559][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:19,588][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:19,607][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:19,629][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:19,648][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:19,667][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:19,688][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:19,708][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:19,728][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:19,748][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:19,848][root][INFO] - Class sequence: [6 5 5 7 5 1 3 7 0 2 4 8 7 3 3 7 4 5 2 0]
[2023-10-17 21:18:19,866][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:19,886][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:19,907][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:19,927][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:19,947][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:19,969][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:19,989][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:20,009][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:20,029][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:20,049][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:20,149][root][INFO] - Class sequence: [5 4 2 3 6 2 0 5 9 4 8 4 1 7 2 5 5 3 9 6]
[2023-10-17 21:18:20,167][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:20,188][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:20,209][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:20,229][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:20,253][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:20,273][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:20,294][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:20,315][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:20,337][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:20,357][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:20,459][root][INFO] - Class sequence: [6 9 8 3 9 7 6 3 0 2 8 6 3 8 5 7 1 4 0 2]
[2023-10-17 21:18:20,478][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:20,499][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:20,519][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:20,540][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:20,560][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:20,581][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:20,605][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:20,625][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:20,646][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:20,668][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:20,769][root][INFO] - Class sequence: [9 2 7 6 8 4 8 5 3 9 0 6 6 9 3 9 7 0 1 4]
[2023-10-17 21:18:20,786][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:20,806][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:20,833][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:20,854][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:20,875][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:20,896][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:20,921][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:20,941][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:20,961][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:20,982][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:21,084][root][INFO] - Class sequence: [1 2 4 6 1 7 8 7 5 7 6 8 0 5 0 5 6 1 5 2]
[2023-10-17 21:18:21,102][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:21,124][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:21,144][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:21,164][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:21,185][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:21,206][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:21,227][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:21,248][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:21,269][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:21,290][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:21,392][root][INFO] - Class sequence: [2 9 0 6 4 1 1 4 9 7 7 5 9 2 2 7 8 9 8 0]
[2023-10-17 21:18:21,410][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:21,430][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:21,451][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:21,474][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:21,493][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:21,514][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:21,534][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:21,555][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:21,575][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:21,596][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:21,698][root][INFO] - Class sequence: [2 7 2 4 0 8 5 9 1 9 7 4 4 9 4 8 7 1 0 5]
[2023-10-17 21:18:21,716][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:21,736][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:21,763][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:21,784][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:21,805][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:21,827][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:21,847][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:21,867][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:21,888][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:21,909][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_dynamic.CompositionalDynamicER'>
[2023-10-17 21:18:22,013][root][INFO] - Class sequence: [6 5 8 5 7 8 1 5 1 7 9 5 2 0 1 8 4 2 2 1]
[2023-10-17 21:18:22,031][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:22,052][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:22,073][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:22,094][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:22,115][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:22,136][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:22,157][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:22,179][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:22,198][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:22,218][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:37,149][root][INFO] - Joint training on task 0 ...
[2023-10-17 21:18:43,191][root][INFO] - Joint training on task 1 ...
[2023-10-17 21:18:44,302][root][INFO] - Joint training on task 2 ...
[2023-10-17 21:18:45,691][root][INFO] - Joint training on task 3 ...
[2023-10-17 21:21:02,500][root][INFO] - DONE TRAINING THE JOINT AGENT...
[2023-10-17 21:21:02,501][root][INFO] - No. gpus per agent: 0.25
[2023-10-17 21:21:08,351][root][INFO] - Created fleet with 8 agents
[2023-10-17 21:21:08,352][root][INFO] - Adding neighbors...
[2023-10-17 21:21:08,423][root][INFO] - Fleet initialized
[2023-10-17 21:21:08,432][root][INFO] - READY TO TRAIN INDIVIDUAL AGENTS...
