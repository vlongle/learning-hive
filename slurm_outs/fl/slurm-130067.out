{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 1}, 'dataset': {'dataset_name': 'kmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'gradient', 'num_coms_per_round': 1, 'comm_freq': 10, 'mu': 1.0}, 'seed': 2, 'algo': 'modular', 'job_name': 'kmnist_modular_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/fedavg/', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-17 21:18:28,724][root][INFO] - Class sequence: [3 9 5 0 5 1 8 6 4 5 5 3 0 9 7 6 6 3 6 3]
[2023-10-17 21:18:28,744][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:28,813][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:28,838][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:28,863][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:28,891][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:28,914][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:28,943][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:28,972][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:29,000][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:29,029][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:29,347][root][INFO] - Class sequence: [0 5 3 0 7 9 4 6 7 6 3 0 7 3 5 4 4 1 3 9]
[2023-10-17 21:18:29,367][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:29,391][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:29,420][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:29,447][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:29,475][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:29,505][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:29,538][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:29,562][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:29,590][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:29,618][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:29,932][root][INFO] - Class sequence: [4 7 3 1 0 1 2 3 8 4 2 3 8 6 8 2 2 1 9 1]
[2023-10-17 21:18:29,952][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:29,979][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:30,001][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:30,029][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:30,058][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:30,090][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:30,122][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:30,150][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:30,179][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:30,205][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:30,519][root][INFO] - Class sequence: [3 1 7 2 4 0 7 8 9 6 6 0 2 4 8 4 5 9 6 1]
[2023-10-17 21:18:30,537][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:30,562][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:30,586][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:30,614][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:30,642][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:30,670][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:30,698][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:30,726][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:30,754][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:30,782][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:31,103][root][INFO] - Class sequence: [7 8 9 7 4 1 5 3 3 8 0 8 8 6 5 6 3 0 3 6]
[2023-10-17 21:18:31,123][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:31,150][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:31,178][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:31,209][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:31,230][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:31,258][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:31,285][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:31,307][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:31,329][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:31,357][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:31,668][root][INFO] - Class sequence: [5 9 6 0 1 4 7 2 5 4 5 4 6 4 7 8 9 3 5 1]
[2023-10-17 21:18:31,688][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:31,715][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:31,738][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:31,768][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:31,795][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:31,822][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:31,844][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:31,872][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:31,894][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:31,928][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:32,236][root][INFO] - Class sequence: [1 9 6 3 8 5 2 3 0 7 7 0 4 3 0 9 3 7 9 4]
[2023-10-17 21:18:32,254][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:32,283][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:32,312][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:32,337][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:32,371][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:32,400][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:32,427][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:32,453][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:32,487][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:32,509][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:32,832][root][INFO] - Class sequence: [7 3 7 3 4 3 9 6 1 2 2 3 0 8 2 1 0 5 5 6]
[2023-10-17 21:18:32,852][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:32,879][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:32,901][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:32,929][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:32,954][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:32,977][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:33,005][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:33,030][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:33,063][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:33,089][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_dynamic.CompositionalDynamicER'>
[2023-10-17 21:18:33,409][root][INFO] - Class sequence: [3 8 3 0 2 7 2 5 2 4 8 3 3 4 1 8 6 2 2 5]
[2023-10-17 21:18:33,428][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:18:33,450][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:18:33,479][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:18:33,514][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:18:33,542][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:18:33,566][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:18:33,594][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:18:33,621][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:18:33,650][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:18:33,682][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:18:49,152][root][INFO] - Joint training on task 0 ...
[2023-10-17 21:18:54,241][root][INFO] - Joint training on task 1 ...
[2023-10-17 21:18:55,178][root][INFO] - Joint training on task 2 ...
[2023-10-17 21:18:56,504][root][INFO] - Joint training on task 3 ...
[2023-10-17 21:21:27,159][root][INFO] - DONE TRAINING THE JOINT AGENT...
[2023-10-17 21:21:27,160][root][INFO] - No. gpus per agent: 0.25
[2023-10-17 21:21:32,147][root][INFO] - Created fleet with 8 agents
[2023-10-17 21:21:32,147][root][INFO] - Adding neighbors...
[2023-10-17 21:21:32,769][root][INFO] - Fleet initialized
[2023-10-17 21:21:32,778][root][INFO] - READY TO TRAIN INDIVIDUAL AGENTS...
