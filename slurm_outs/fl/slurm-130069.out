{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 1}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'gradient', 'num_coms_per_round': 1, 'comm_freq': 10, 'mu': 1.0}, 'seed': 3, 'algo': 'modular', 'job_name': 'fashionmnist_modular_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/fedavg/', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-17 21:33:26,598][root][INFO] - Class sequence: [9 2 0 7 0 6 4 3 9 5 4 9 8 0 3 0 7 6 6 1]
[2023-10-17 21:33:26,618][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:26,678][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:26,702][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:26,726][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:26,748][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:26,773][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:26,797][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:26,825][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:26,852][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:26,873][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:33:26,985][root][INFO] - Class sequence: [5 4 3 0 1 2 9 3 6 0 3 6 9 7 3 6 0 9 4 1]
[2023-10-17 21:33:27,004][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:27,030][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:27,065][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:27,099][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:27,122][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:27,151][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:27,173][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:27,200][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:27,227][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:27,249][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:33:27,358][root][INFO] - Class sequence: [8 0 2 6 0 4 9 4 0 6 0 1 6 9 0 2 8 7 1 9]
[2023-10-17 21:33:27,377][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:27,407][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:27,428][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:27,456][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:27,478][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:27,501][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:27,530][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:27,554][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:27,576][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:27,602][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:33:27,716][root][INFO] - Class sequence: [7 3 2 4 0 9 4 6 0 2 1 0 0 4 0 8 4 9 5 1]
[2023-10-17 21:33:27,735][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:27,763][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:27,795][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:27,823][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:27,844][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:27,865][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:27,887][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:27,913][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:27,935][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:27,968][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:33:28,082][root][INFO] - Class sequence: [7 1 2 3 1 5 2 1 1 4 4 0 0 1 2 5 3 5 3 0]
[2023-10-17 21:33:28,101][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:28,132][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:28,158][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:28,189][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:28,217][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:28,242][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:28,269][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:28,294][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:28,317][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:28,341][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:33:28,456][root][INFO] - Class sequence: [3 5 9 0 5 7 8 1 1 0 2 3 5 2 3 4 5 3 4 3]
[2023-10-17 21:33:28,474][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:28,501][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:28,521][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:28,543][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:28,571][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:28,597][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:28,624][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:28,649][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:28,674][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:28,697][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:33:28,805][root][INFO] - Class sequence: [0 1 9 4 1 6 0 7 5 6 5 2 1 8 6 4 2 3 6 4]
[2023-10-17 21:33:28,823][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:28,850][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:28,878][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:28,901][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:28,928][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:28,949][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:28,970][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:28,990][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:29,020][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:29,040][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:33:29,143][root][INFO] - Class sequence: [5 4 7 0 5 9 9 6 9 8 9 5 2 6 3 9 2 0 8 1]
[2023-10-17 21:33:29,161][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:29,182][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:29,203][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:29,224][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:29,259][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:29,281][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:29,309][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:29,333][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:29,354][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:29,386][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_dynamic.CompositionalDynamicER'>
[2023-10-17 21:33:29,499][root][INFO] - Class sequence: [6 0 5 1 1 3 6 2 9 1 9 3 6 4 2 1 0 3 0 3]
[2023-10-17 21:33:29,517][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:33:29,544][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:33:29,564][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:33:29,589][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:33:29,609][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:33:29,637][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:33:29,668][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:33:29,693][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:33:29,717][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:33:29,751][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:33:45,122][root][INFO] - Joint training on task 0 ...
[2023-10-17 21:33:49,878][root][INFO] - Joint training on task 1 ...
[2023-10-17 21:33:50,780][root][INFO] - Joint training on task 2 ...
[2023-10-17 21:33:52,018][root][INFO] - Joint training on task 3 ...
[2023-10-17 21:36:12,359][root][INFO] - DONE TRAINING THE JOINT AGENT...
[2023-10-17 21:36:12,360][root][INFO] - No. gpus per agent: 0.25
[2023-10-17 21:36:17,696][root][INFO] - Created fleet with 8 agents
[2023-10-17 21:36:17,696][root][INFO] - Adding neighbors...
[2023-10-17 21:36:18,318][root][INFO] - Fleet initialized
[2023-10-17 21:36:18,326][root][INFO] - READY TO TRAIN INDIVIDUAL AGENTS...
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=944912)[0m node 0 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=945065)[0m node 1 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=945084)[0m node 2 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=945178)[0m node 3 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=945936)[0m node 5 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=945263)[0m node 4 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=946562)[0m node 6 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=946786)[0m node 7 is processing at round 9 for task 0
{'algo': 'modular', 'seed': 3, 'parallel': True, 'agent.batch_size': 64, 'num_agents': 8, 'dataset': 'fashionmnist', 'dataset.num_trains_per_class': 64, 'dataset.num_vals_per_class': 50, 'dataset.remap_labels': True, 'dataset.with_replacement': True, 'dataset.num_tasks': 10, 'net': 'mlp', 'net.depth': 4, 'num_init_tasks': 4, 'net.dropout': 0.0, 'train.num_epochs': 100, 'train.component_update_freq': 100, 'train.init_num_epochs': 100, 'train.init_component_update_freq': 100, 'train.save_freq': 1, 'agent.use_contrastive': True, 'agent.memory_size': 32, 'root_save_dir': 'experiment_results/fedavg/', 'sharing_strategy': 'grad_sharing', 'sharing_strategy.comm_freq': 10}
No. of experiments: 1
Experiment runs took 0:05:20.089785
