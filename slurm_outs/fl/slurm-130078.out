{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 1}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'gradient', 'num_coms_per_round': 1, 'comm_freq': 10, 'mu': 1.0}, 'seed': 2, 'algo': 'modular', 'job_name': 'fashionmnist_modular_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/fedavg/', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-17 21:31:45,482][root][INFO] - Class sequence: [3 9 5 0 5 1 8 6 4 5 5 3 0 9 7 6 6 3 6 3]
[2023-10-17 21:31:45,501][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:45,550][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:45,574][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:45,595][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:45,615][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:45,636][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:45,654][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:45,674][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:45,695][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:45,715][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:31:45,814][root][INFO] - Class sequence: [0 5 3 0 7 9 4 6 7 6 3 0 7 3 5 4 4 1 3 9]
[2023-10-17 21:31:45,832][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:45,852][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:45,873][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:45,895][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:45,915][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:45,935][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:45,955][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:45,975][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:45,996][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:46,016][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:31:46,115][root][INFO] - Class sequence: [4 7 3 1 0 1 2 3 8 4 2 3 8 6 8 2 2 1 9 1]
[2023-10-17 21:31:46,133][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:46,152][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:46,172][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:46,193][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:46,219][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:46,239][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:46,259][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:46,287][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:46,306][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:46,326][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:31:46,426][root][INFO] - Class sequence: [3 1 7 2 4 0 7 8 9 6 6 0 2 4 8 4 5 9 6 1]
[2023-10-17 21:31:46,443][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:46,463][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:46,483][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:46,502][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:46,522][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:46,545][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:46,565][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:46,585][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:46,606][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:46,627][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:31:46,727][root][INFO] - Class sequence: [7 8 9 7 4 1 5 3 3 8 0 8 8 6 5 6 3 0 3 6]
[2023-10-17 21:31:46,743][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:46,763][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:46,782][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:46,802][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:46,823][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:46,841][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:46,861][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:46,881][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:46,901][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:46,926][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:31:47,026][root][INFO] - Class sequence: [5 9 6 0 1 4 7 2 5 4 5 4 6 4 7 8 9 3 5 1]
[2023-10-17 21:31:47,044][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:47,064][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:47,084][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:47,103][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:47,122][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:47,142][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:47,162][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:47,181][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:47,201][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:47,221][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:31:47,322][root][INFO] - Class sequence: [1 9 6 3 8 5 2 3 0 7 7 0 4 3 0 9 3 7 9 4]
[2023-10-17 21:31:47,339][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:47,358][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:47,378][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:47,398][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:47,418][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:47,437][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:47,456][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:47,474][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:47,495][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:47,514][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:31:47,613][root][INFO] - Class sequence: [7 3 7 3 4 3 9 6 1 2 2 3 0 8 2 1 0 5 5 6]
[2023-10-17 21:31:47,630][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:47,650][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:47,670][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:47,689][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:47,708][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:47,728][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:47,748][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:47,773][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:47,793][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:47,812][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_dynamic.CompositionalDynamicER'>
[2023-10-17 21:31:47,916][root][INFO] - Class sequence: [3 8 3 0 2 7 2 5 2 4 8 3 3 4 1 8 6 2 2 5]
[2023-10-17 21:31:47,934][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-17 21:31:47,953][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-17 21:31:47,973][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-17 21:31:47,999][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-17 21:31:48,020][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-17 21:31:48,038][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-17 21:31:48,058][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-17 21:31:48,077][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-17 21:31:48,097][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-17 21:31:48,119][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-17 21:32:02,678][root][INFO] - Joint training on task 0 ...
[2023-10-17 21:32:07,579][root][INFO] - Joint training on task 1 ...
[2023-10-17 21:32:08,422][root][INFO] - Joint training on task 2 ...
[2023-10-17 21:32:09,628][root][INFO] - Joint training on task 3 ...
[2023-10-17 21:34:17,945][root][INFO] - DONE TRAINING THE JOINT AGENT...
[2023-10-17 21:34:17,946][root][INFO] - No. gpus per agent: 0.25
[2023-10-17 21:34:23,647][root][INFO] - Created fleet with 8 agents
[2023-10-17 21:34:23,647][root][INFO] - Adding neighbors...
[2023-10-17 21:34:23,656][root][INFO] - Fleet initialized
[2023-10-17 21:34:23,664][root][INFO] - READY TO TRAIN INDIVIDUAL AGENTS...
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 0 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 1 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 2 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 3 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 4 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 5 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 6 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 7 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 8 for task 0
[2m[36m(ParallelModGrad pid=3108818)[0m node 0 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=3108821)[0m node 1 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=3108822)[0m node 2 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=3108851)[0m node 3 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=3108906)[0m node 5 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=3108905)[0m node 4 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=3108907)[0m node 6 is processing at round 9 for task 0
[2m[36m(ParallelModGrad pid=3108908)[0m node 7 is processing at round 9 for task 0
{'algo': 'modular', 'seed': 2, 'parallel': True, 'agent.batch_size': 64, 'num_agents': 8, 'dataset': 'fashionmnist', 'dataset.num_trains_per_class': 64, 'dataset.num_vals_per_class': 50, 'dataset.remap_labels': True, 'dataset.with_replacement': True, 'dataset.num_tasks': 10, 'net': 'mlp', 'net.depth': 4, 'num_init_tasks': 4, 'net.dropout': 0.0, 'train.num_epochs': 100, 'train.component_update_freq': 100, 'train.init_num_epochs': 100, 'train.init_component_update_freq': 100, 'train.save_freq': 1, 'agent.use_contrastive': True, 'agent.memory_size': 32, 'root_save_dir': 'experiment_results/fedavg/', 'sharing_strategy': 'grad_sharing', 'sharing_strategy.comm_freq': 10}
No. of experiments: 1
Experiment runs took 0:04:24.995164
