/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 20}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'no_sharing', 'num_coms_per_round': 0}, 'seed': 3, 'algo': 'monolithic', 'job_name': 'fashionmnist_monolithic_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-04 19:37:34,015][root][INFO] - Class sequence: [9 2 0 7 0 6 4 3 9 5 4 9 8 0 3 0 7 6 6 1]
[2023-10-04 19:37:34,034][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:37:34,086][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:37:34,108][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:37:34,130][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:37:34,152][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:37:34,174][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:37:34,195][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:37:34,216][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:37:34,237][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:37:34,258][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:37:34,367][root][INFO] - Class sequence: [5 4 3 0 1 2 9 3 6 0 3 6 9 7 3 6 0 9 4 1]
[2023-10-04 19:37:34,386][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:37:34,409][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:37:34,431][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:37:34,452][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:37:34,514][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:37:34,536][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:37:34,563][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:37:34,589][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:37:34,609][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:37:34,630][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:37:34,741][root][INFO] - Class sequence: [8 0 2 6 0 4 9 4 0 6 0 1 6 9 0 2 8 7 1 9]
[2023-10-04 19:37:34,758][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:37:34,785][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:37:34,806][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:37:34,828][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:37:34,850][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:37:34,871][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:37:34,892][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:37:34,913][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:37:34,934][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:37:34,954][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:37:35,072][root][INFO] - Class sequence: [7 3 2 4 0 9 4 6 0 2 1 0 0 4 0 8 4 9 5 1]
[2023-10-04 19:37:35,090][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:37:35,115][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:37:35,134][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:37:35,155][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:37:35,182][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:37:35,208][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:37:35,235][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:37:35,254][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:37:35,275][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:37:35,302][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:37:35,418][root][INFO] - Class sequence: [7 1 2 3 1 5 2 1 1 4 4 0 0 1 2 5 3 5 3 0]
[2023-10-04 19:37:35,437][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:37:35,457][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:37:35,478][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:37:35,498][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:37:35,518][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:37:35,544][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:37:35,564][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:37:35,615][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:37:35,635][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:37:35,677][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:37:35,823][root][INFO] - Class sequence: [3 5 9 0 5 7 8 1 1 0 2 3 5 2 3 4 5 3 4 3]
[2023-10-04 19:37:35,876][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:37:35,965][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:37:36,039][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:37:36,115][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:37:36,210][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:37:36,263][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:37:36,327][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:37:36,403][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:37:36,472][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:37:36,533][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:37:36,638][root][INFO] - Class sequence: [0 1 9 4 1 6 0 7 5 6 5 2 1 8 6 4 2 3 6 4]
[2023-10-04 19:37:36,683][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:37:36,734][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:37:36,779][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:37:36,824][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:37:36,885][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:37:36,949][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:37:37,027][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:37:37,054][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:37:37,092][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:37:37,134][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:37:37,248][root][INFO] - Class sequence: [5 4 7 0 5 9 9 6 9 8 9 5 2 6 3 9 2 0 8 1]
[2023-10-04 19:37:37,302][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:37:37,373][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:37:37,442][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:37:37,501][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:37:37,564][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:37:37,621][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:37:37,682][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:37:37,759][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:37:37,860][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:37:37,943][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_nocomponents.NoComponentsER'>
[2023-10-04 19:37:37,969][root][INFO] - No. gpus per agent: 0.25
2023-10-04 19:37:40,511	INFO worker.py:1544 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[2m[36m(ParallelAgent pid=1015379)[0m INFO:root:Agent: node_id: 3, seed: 3003
[2m[36m(ParallelAgent pid=1015376)[0m INFO:root:Agent: node_id: 0, seed: 3
[2m[36m(ParallelAgent pid=1015377)[0m INFO:root:Agent: node_id: 1, seed: 1003
[2m[36m(ParallelAgent pid=1015378)[0m INFO:root:Agent: node_id: 2, seed: 2003
[2m[36m(ParallelAgent pid=1015380)[0m INFO:root:Agent: node_id: 4, seed: 4003
[2m[36m(ParallelAgent pid=1015439)[0m INFO:root:Agent: node_id: 5, seed: 5003
[2m[36m(ParallelAgent pid=1015564)[0m INFO:root:Agent: node_id: 6, seed: 6003
[2m[36m(ParallelAgent pid=1015792)[0m INFO:root:Agent: node_id: 7, seed: 7003
[2023-10-04 19:38:00,368][root][INFO] - Created fleet with 8 agents
[2023-10-04 19:38:00,369][root][INFO] - Adding neighbors...
[2023-10-04 19:38:00,378][root][INFO] - Fleet initialized
Error executing job with overrides: ['algo=monolithic', 'agent.batch_size=64', 'seed=3', 'parallel=True', 'num_agents=8', 'dataset=fashionmnist', 'dataset.num_trains_per_class=64', 'dataset.num_vals_per_class=50', 'dataset.remap_labels=True', 'dataset.with_replacement=True', 'dataset.num_tasks=10', 'net=mlp', 'net.depth=4', 'num_init_tasks=4', 'net.dropout=0.0', 'train.num_epochs=100', 'train.component_update_freq=100', 'train.init_num_epochs=100', 'train.init_component_update_freq=100', 'train.save_freq=20', 'agent.use_contrastive=True', 'agent.memory_size=32', 'root_save_dir=experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'train=monolithic', 'job_name=fashionmnist_monolithic_numtrain_64_contrastive']
Traceback (most recent call last):
  File "/home/vlongle/learning-hive/experiments/run.py", line 41, in main
    fleet.train_and_comm(task_id)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 274, in train_and_comm
    ray.get([agent.train.remote(task_id, start_epoch, self.comm_freq) for agent in self.agents])
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/worker.py", line 2380, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(AttributeError): [36mray::ParallelAgent.train()[39m (pid=1015376, ip=192.168.141.55, repr=<shell.fleet.fleet.ParallelAgent object at 0x7f24fe7beb60>)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 97, in train
    self.agent.train(trainloader, task_id, testloaders=testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/er_nocomponents.py", line 36, in train
    self.save_data(start_epoch, task_id, testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 226, in save_data
    self.test_loss, self.test_acc = self.evaluate(testloaders, mode=mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 198, in evaluate
    l += self.compute_loss(X, Y, task, mode='ce').item()
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 140, in compute_loss
    return self.compute_cross_entropy_loss(X, Y, task_id, detach=False)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 109, in compute_cross_entropy_loss
    X_encode = self.net.encodev2(X, task_id)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'MLP' object has no attribute 'encodev2'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 20}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'no_sharing', 'num_coms_per_round': 0}, 'seed': 3, 'algo': 'modular', 'job_name': 'fashionmnist_modular_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-04 19:38:12,517][root][INFO] - Class sequence: [9 2 0 7 0 6 4 3 9 5 4 9 8 0 3 0 7 6 6 1]
[2023-10-04 19:38:12,796][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:13,077][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:13,260][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:13,448][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:13,592][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:13,754][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:13,931][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:14,080][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:14,233][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:14,410][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:14,519][root][INFO] - Class sequence: [5 4 3 0 1 2 9 3 6 0 3 6 9 7 3 6 0 9 4 1]
[2023-10-04 19:38:14,639][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:14,760][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:14,853][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:14,929][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:15,014][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:15,105][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:15,166][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:15,232][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:15,312][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:15,386][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:15,497][root][INFO] - Class sequence: [8 0 2 6 0 4 9 4 0 6 0 1 6 9 0 2 8 7 1 9]
[2023-10-04 19:38:15,547][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:15,579][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:15,620][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:15,668][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:15,726][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:15,777][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:15,836][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:15,913][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:16,009][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:16,053][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:16,160][root][INFO] - Class sequence: [7 3 2 4 0 9 4 6 0 2 1 0 0 4 0 8 4 9 5 1]
[2023-10-04 19:38:16,224][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:16,278][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:16,348][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:16,415][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:16,496][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:16,561][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:16,624][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:16,693][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:16,759][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:16,828][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:16,934][root][INFO] - Class sequence: [7 1 2 3 1 5 2 1 1 4 4 0 0 1 2 5 3 5 3 0]
[2023-10-04 19:38:17,018][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:17,105][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:17,130][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:17,150][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:17,194][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:17,251][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:17,303][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:17,357][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:17,414][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:17,472][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:17,580][root][INFO] - Class sequence: [3 5 9 0 5 7 8 1 1 0 2 3 5 2 3 4 5 3 4 3]
[2023-10-04 19:38:17,648][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:17,710][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:17,774][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:17,883][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:17,990][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:18,051][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:18,125][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:18,179][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:18,225][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:18,293][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:18,406][root][INFO] - Class sequence: [0 1 9 4 1 6 0 7 5 6 5 2 1 8 6 4 2 3 6 4]
[2023-10-04 19:38:18,479][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:18,553][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:18,635][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:18,710][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:18,778][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:18,832][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:18,892][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:18,912][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:18,975][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:19,017][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:19,125][root][INFO] - Class sequence: [5 4 7 0 5 9 9 6 9 8 9 5 2 6 3 9 2 0 8 1]
[2023-10-04 19:38:19,189][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:19,253][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:19,292][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:19,312][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:19,333][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:19,354][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:19,405][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:19,425][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:19,445][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:19,466][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_dynamic.CompositionalDynamicER'>
[2023-10-04 19:38:19,496][root][INFO] - No. gpus per agent: 0.25
2023-10-04 19:38:21,903	INFO worker.py:1544 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[2m[36m(ParallelAgent pid=1054791)[0m INFO:root:Agent: node_id: 1, seed: 1003
[2m[36m(ParallelAgent pid=1054793)[0m INFO:root:Agent: node_id: 3, seed: 3003
[2m[36m(ParallelAgent pid=1054790)[0m INFO:root:Agent: node_id: 0, seed: 3
[2m[36m(ParallelAgent pid=1054794)[0m INFO:root:Agent: node_id: 4, seed: 4003
[2m[36m(ParallelAgent pid=1054792)[0m INFO:root:Agent: node_id: 2, seed: 2003
[2m[36m(ParallelAgent pid=1054853)[0m INFO:root:Agent: node_id: 5, seed: 5003
[2m[36m(ParallelAgent pid=1054979)[0m INFO:root:Agent: node_id: 6, seed: 6003
[2m[36m(ParallelAgent pid=1055168)[0m INFO:root:Agent: node_id: 7, seed: 7003
[2023-10-04 19:38:41,694][root][INFO] - Created fleet with 8 agents
[2023-10-04 19:38:41,695][root][INFO] - Adding neighbors...
[2023-10-04 19:38:41,705][root][INFO] - Fleet initialized
Error executing job with overrides: ['algo=modular', 'agent.batch_size=64', 'seed=3', 'parallel=True', 'num_agents=8', 'dataset=fashionmnist', 'dataset.num_trains_per_class=64', 'dataset.num_vals_per_class=50', 'dataset.remap_labels=True', 'dataset.with_replacement=True', 'dataset.num_tasks=10', 'net=mlp', 'net.depth=4', 'num_init_tasks=4', 'net.dropout=0.0', 'train.num_epochs=100', 'train.component_update_freq=100', 'train.init_num_epochs=100', 'train.init_component_update_freq=100', 'train.save_freq=20', 'agent.use_contrastive=True', 'agent.memory_size=32', 'root_save_dir=experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'train=modular', 'job_name=fashionmnist_modular_numtrain_64_contrastive']
Traceback (most recent call last):
  File "/home/vlongle/learning-hive/experiments/run.py", line 41, in main
    fleet.train_and_comm(task_id)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 274, in train_and_comm
    ray.get([agent.train.remote(task_id, start_epoch, self.comm_freq) for agent in self.agents])
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/worker.py", line 2380, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(AttributeError): [36mray::ParallelAgent.train()[39m (pid=1054853, ip=192.168.141.55, repr=<shell.fleet.fleet.ParallelAgent object at 0x7efe39c7eb30>)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 97, in train
    self.agent.train(trainloader, task_id, testloaders=testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 293, in train
    self.save_data(start_epoch, task_id, testloaders, mode=train_mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 515, in save_data
    super().save_data(epoch, task_id, testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 226, in save_data
    self.test_loss, self.test_acc = self.evaluate(testloaders, mode=mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 477, in evaluate
    l += self.compute_loss(X, Y, task, mode='ce').item()
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 140, in compute_loss
    return self.compute_cross_entropy_loss(X, Y, task_id, detach=False)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 109, in compute_cross_entropy_loss
    X_encode = self.net.encodev2(X, task_id)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'MLPSoftLLDynamic' object has no attribute 'encodev2'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
{'algo': ['monolithic', 'modular'], 'agent.batch_size': 64, 'seed': 3, 'parallel': True, 'num_agents': 8, 'dataset': 'fashionmnist', 'dataset.num_trains_per_class': 64, 'dataset.num_vals_per_class': 50, 'dataset.remap_labels': True, 'dataset.with_replacement': True, 'dataset.num_tasks': 10, 'net': 'mlp', 'net.depth': 4, 'num_init_tasks': 4, 'net.dropout': 0.0, 'train.num_epochs': 100, 'train.component_update_freq': 100, 'train.init_num_epochs': 100, 'train.init_component_update_freq': 100, 'train.save_freq': 20, 'agent.use_contrastive': True, 'agent.memory_size': 32, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2'}
No. of experiments: 2
Experiment runs took 0:01:20.247248
