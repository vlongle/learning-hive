/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 20}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'no_sharing', 'num_coms_per_round': 0}, 'seed': 5, 'algo': 'monolithic', 'job_name': 'fashionmnist_monolithic_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-04 19:38:05,169][root][INFO] - Class sequence: [1 8 2 9 1 3 7 6 5 0 6 9 6 9 0 2 5 6 6 5]
[2023-10-04 19:38:05,188][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:05,234][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:05,255][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:05,275][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:05,296][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:05,316][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:05,336][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:05,357][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:05,376][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:05,396][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:05,500][root][INFO] - Class sequence: [7 3 8 1 3 7 0 8 9 7 1 7 2 4 7 3 3 1 0 9]
[2023-10-04 19:38:05,518][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:05,538][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:05,558][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:05,577][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:05,597][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:05,618][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:05,637][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:05,663][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:05,683][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:05,702][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:05,806][root][INFO] - Class sequence: [4 2 1 0 2 3 0 5 0 1 0 3 9 6 5 6 6 5 5 3]
[2023-10-04 19:38:05,823][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:05,843][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:05,862][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:05,883][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:05,908][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:05,928][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:05,948][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:05,968][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:05,988][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:06,007][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:06,112][root][INFO] - Class sequence: [9 3 3 5 1 9 4 5 9 7 0 9 6 0 0 6 8 5 5 4]
[2023-10-04 19:38:06,130][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:06,150][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:06,168][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:06,188][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:06,207][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:06,269][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:06,289][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:06,309][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:06,329][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:06,355][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:06,458][root][INFO] - Class sequence: [3 4 6 0 2 9 9 2 4 5 8 0 6 4 3 9 7 0 6 0]
[2023-10-04 19:38:06,474][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:06,494][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:06,514][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:06,534][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:06,552][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:06,572][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:06,591][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:06,612][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:06,630][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:06,650][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:06,758][root][INFO] - Class sequence: [6 9 9 3 1 5 3 8 8 9 0 4 5 4 2 9 0 8 7 6]
[2023-10-04 19:38:06,777][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:06,797][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:06,816][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:06,836][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:06,856][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:06,877][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:06,895][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:06,915][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:06,934][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:06,953][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:07,057][root][INFO] - Class sequence: [9 5 0 8 1 3 6 8 2 9 3 0 2 0 0 7 9 6 5 8]
[2023-10-04 19:38:07,075][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:07,094][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:07,114][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:07,134][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:07,153][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:07,172][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:07,192][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:07,212][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:07,239][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:07,259][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:07,363][root][INFO] - Class sequence: [6 0 8 2 8 1 3 7 3 8 1 5 9 1 2 8 9 3 1 4]
[2023-10-04 19:38:07,381][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:07,401][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:07,420][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:07,440][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:07,460][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:07,481][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:07,499][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:07,519][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:07,539][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:07,559][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_nocomponents.NoComponentsER'>
[2023-10-04 19:38:07,583][root][INFO] - No. gpus per agent: 0.25
2023-10-04 19:38:10,013	INFO worker.py:1544 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[2m[36m(ParallelAgent pid=381959)[0m INFO:root:Agent: node_id: 0, seed: 5
[2m[36m(ParallelAgent pid=381960)[0m INFO:root:Agent: node_id: 1, seed: 1005
[2m[36m(ParallelAgent pid=381961)[0m INFO:root:Agent: node_id: 2, seed: 2005
[2m[36m(ParallelAgent pid=381962)[0m INFO:root:Agent: node_id: 3, seed: 3005
[2m[36m(ParallelAgent pid=381963)[0m INFO:root:Agent: node_id: 4, seed: 4005
[2m[36m(ParallelAgent pid=382022)[0m INFO:root:Agent: node_id: 5, seed: 5005
[2m[36m(ParallelAgent pid=382147)[0m INFO:root:Agent: node_id: 6, seed: 6005
[2m[36m(ParallelAgent pid=382208)[0m INFO:root:Agent: node_id: 7, seed: 7005
[2023-10-04 19:38:28,114][root][INFO] - Created fleet with 8 agents
[2023-10-04 19:38:28,115][root][INFO] - Adding neighbors...
[2023-10-04 19:38:28,123][root][INFO] - Fleet initialized
Error executing job with overrides: ['algo=monolithic', 'agent.batch_size=64', 'seed=5', 'parallel=True', 'num_agents=8', 'dataset=fashionmnist', 'dataset.num_trains_per_class=64', 'dataset.num_vals_per_class=50', 'dataset.remap_labels=True', 'dataset.with_replacement=True', 'dataset.num_tasks=10', 'net=mlp', 'net.depth=4', 'num_init_tasks=4', 'net.dropout=0.0', 'train.num_epochs=100', 'train.component_update_freq=100', 'train.init_num_epochs=100', 'train.init_component_update_freq=100', 'train.save_freq=20', 'agent.use_contrastive=True', 'agent.memory_size=32', 'root_save_dir=experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'train=monolithic', 'job_name=fashionmnist_monolithic_numtrain_64_contrastive']
Traceback (most recent call last):
  File "/home/vlongle/learning-hive/experiments/run.py", line 41, in main
    fleet.train_and_comm(task_id)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 274, in train_and_comm
    ray.get([agent.train.remote(task_id, start_epoch, self.comm_freq) for agent in self.agents])
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/worker.py", line 2380, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(AttributeError): [36mray::ParallelAgent.train()[39m (pid=382147, ip=192.168.141.69, repr=<shell.fleet.fleet.ParallelAgent object at 0x7f3f71d96b30>)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 97, in train
    self.agent.train(trainloader, task_id, testloaders=testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/er_nocomponents.py", line 36, in train
    self.save_data(start_epoch, task_id, testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 226, in save_data
    self.test_loss, self.test_acc = self.evaluate(testloaders, mode=mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 198, in evaluate
    l += self.compute_loss(X, Y, task, mode='ce').item()
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 140, in compute_loss
    return self.compute_cross_entropy_loss(X, Y, task_id, detach=False)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 109, in compute_cross_entropy_loss
    X_encode = self.net.encodev2(X, task_id)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'MLP' object has no attribute 'encodev2'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 20}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'no_sharing', 'num_coms_per_round': 0}, 'seed': 5, 'algo': 'modular', 'job_name': 'fashionmnist_modular_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-04 19:38:40,061][root][INFO] - Class sequence: [1 8 2 9 1 3 7 6 5 0 6 9 6 9 0 2 5 6 6 5]
[2023-10-04 19:38:40,079][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:40,125][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:40,146][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:40,166][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:40,187][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:40,207][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:40,227][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:40,247][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:40,265][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:40,285][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:40,386][root][INFO] - Class sequence: [7 3 8 1 3 7 0 8 9 7 1 7 2 4 7 3 3 1 0 9]
[2023-10-04 19:38:40,405][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:40,425][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:40,445][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:40,464][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:40,484][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:40,504][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:40,523][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:40,543][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:40,563][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:40,583][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:40,684][root][INFO] - Class sequence: [4 2 1 0 2 3 0 5 0 1 0 3 9 6 5 6 6 5 5 3]
[2023-10-04 19:38:40,701][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:40,721][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:40,740][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:40,761][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:40,780][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:40,800][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:40,820][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:40,839][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:40,863][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:40,882][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:40,984][root][INFO] - Class sequence: [9 3 3 5 1 9 4 5 9 7 0 9 6 0 0 6 8 5 5 4]
[2023-10-04 19:38:41,001][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:41,022][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:41,040][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:41,060][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:41,079][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:41,099][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:41,118][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:41,138][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:41,158][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:41,178][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:41,279][root][INFO] - Class sequence: [3 4 6 0 2 9 9 2 4 5 8 0 6 4 3 9 7 0 6 0]
[2023-10-04 19:38:41,295][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:41,315][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:41,335][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:41,355][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:41,374][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:41,393][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:41,413][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:41,432][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:41,451][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:41,471][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:41,572][root][INFO] - Class sequence: [6 9 9 3 1 5 3 8 8 9 0 4 5 4 2 9 0 8 7 6]
[2023-10-04 19:38:41,589][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:41,610][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:41,629][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:41,649][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:41,669][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:41,690][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:41,708][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:41,728][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:41,747][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:41,767][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:41,869][root][INFO] - Class sequence: [9 5 0 8 1 3 6 8 2 9 3 0 2 0 0 7 9 6 5 8]
[2023-10-04 19:38:41,886][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:41,905][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:41,925][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:41,945][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:41,964][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:41,984][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:42,004][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:42,024][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:42,043][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:42,124][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:38:42,225][root][INFO] - Class sequence: [6 0 8 2 8 1 3 7 3 8 1 5 9 1 2 8 9 3 1 4]
[2023-10-04 19:38:42,243][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:38:42,263][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:38:42,282][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:38:42,301][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:38:42,322][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:38:42,343][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:38:42,362][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:38:42,382][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:38:42,401][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:38:42,422][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_dynamic.CompositionalDynamicER'>
[2023-10-04 19:38:42,446][root][INFO] - No. gpus per agent: 0.25
2023-10-04 19:38:44,726	INFO worker.py:1544 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[2m[36m(ParallelAgent pid=421349)[0m INFO:root:Agent: node_id: 1, seed: 1005
[2m[36m(ParallelAgent pid=421350)[0m INFO:root:Agent: node_id: 2, seed: 2005
[2m[36m(ParallelAgent pid=421288)[0m INFO:root:Agent: node_id: 0, seed: 5
[2m[36m(ParallelAgent pid=421351)[0m INFO:root:Agent: node_id: 3, seed: 3005
[2m[36m(ParallelAgent pid=421352)[0m INFO:root:Agent: node_id: 4, seed: 4005
[2m[36m(ParallelAgent pid=421411)[0m INFO:root:Agent: node_id: 5, seed: 5005
[2m[36m(ParallelAgent pid=421536)[0m INFO:root:Agent: node_id: 6, seed: 6005
[2m[36m(ParallelAgent pid=421663)[0m INFO:root:Agent: node_id: 7, seed: 7005
[2023-10-04 19:39:03,055][root][INFO] - Created fleet with 8 agents
[2023-10-04 19:39:03,056][root][INFO] - Adding neighbors...
[2023-10-04 19:39:03,065][root][INFO] - Fleet initialized
Error executing job with overrides: ['algo=modular', 'agent.batch_size=64', 'seed=5', 'parallel=True', 'num_agents=8', 'dataset=fashionmnist', 'dataset.num_trains_per_class=64', 'dataset.num_vals_per_class=50', 'dataset.remap_labels=True', 'dataset.with_replacement=True', 'dataset.num_tasks=10', 'net=mlp', 'net.depth=4', 'num_init_tasks=4', 'net.dropout=0.0', 'train.num_epochs=100', 'train.component_update_freq=100', 'train.init_num_epochs=100', 'train.init_component_update_freq=100', 'train.save_freq=20', 'agent.use_contrastive=True', 'agent.memory_size=32', 'root_save_dir=experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'train=modular', 'job_name=fashionmnist_modular_numtrain_64_contrastive']
Traceback (most recent call last):
  File "/home/vlongle/learning-hive/experiments/run.py", line 41, in main
    fleet.train_and_comm(task_id)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 274, in train_and_comm
    ray.get([agent.train.remote(task_id, start_epoch, self.comm_freq) for agent in self.agents])
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/worker.py", line 2380, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(AttributeError): [36mray::ParallelAgent.train()[39m (pid=421536, ip=192.168.141.69, repr=<shell.fleet.fleet.ParallelAgent object at 0x7f3f94142b30>)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 97, in train
    self.agent.train(trainloader, task_id, testloaders=testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 293, in train
    self.save_data(start_epoch, task_id, testloaders, mode=train_mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 515, in save_data
    super().save_data(epoch, task_id, testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 226, in save_data
    self.test_loss, self.test_acc = self.evaluate(testloaders, mode=mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 477, in evaluate
    l += self.compute_loss(X, Y, task, mode='ce').item()
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 140, in compute_loss
    return self.compute_cross_entropy_loss(X, Y, task_id, detach=False)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 109, in compute_cross_entropy_loss
    X_encode = self.net.encodev2(X, task_id)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'MLPSoftLLDynamic' object has no attribute 'encodev2'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
{'algo': ['monolithic', 'modular'], 'agent.batch_size': 64, 'seed': 5, 'parallel': True, 'num_agents': 8, 'dataset': 'fashionmnist', 'dataset.num_trains_per_class': 64, 'dataset.num_vals_per_class': 50, 'dataset.remap_labels': True, 'dataset.with_replacement': True, 'dataset.num_tasks': 10, 'net': 'mlp', 'net.depth': 4, 'num_init_tasks': 4, 'net.dropout': 0.0, 'train.num_epochs': 100, 'train.component_update_freq': 100, 'train.init_num_epochs': 100, 'train.init_component_update_freq': 100, 'train.save_freq': 20, 'agent.use_contrastive': True, 'agent.memory_size': 32, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2'}
No. of experiments: 2
Experiment runs took 0:01:09.635047
