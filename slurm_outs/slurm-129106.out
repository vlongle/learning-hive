/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 20}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'no_sharing', 'num_coms_per_round': 0}, 'seed': 6, 'algo': 'monolithic', 'job_name': 'fashionmnist_monolithic_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-04 19:47:46,951][root][INFO] - Class sequence: [2 3 4 8 8 7 6 9 2 9 1 8 8 7 8 7 4 7 0 2]
[2023-10-04 19:47:46,970][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:47:47,000][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:47:47,027][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:47:47,048][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:47:47,069][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:47:47,089][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:47:47,108][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:47:47,134][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:47:47,155][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:47:47,176][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:47:47,286][root][INFO] - Class sequence: [9 4 5 4 5 3 1 3 5 8 3 1 0 7 4 0 3 1 7 6]
[2023-10-04 19:47:47,304][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:47:47,325][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:47:47,347][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:47:47,367][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:47:47,394][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:47:47,420][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:47:47,447][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:47:47,467][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:47:47,494][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:47:47,513][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:47:47,616][root][INFO] - Class sequence: [8 9 9 8 3 7 1 9 5 0 8 6 6 9 5 7 1 8 0 4]
[2023-10-04 19:47:47,634][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:47:47,655][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:47:47,676][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:47:47,703][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:47:47,724][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:47:47,750][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:47:47,771][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:47:47,797][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:47:47,825][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:47:47,844][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:47:47,952][root][INFO] - Class sequence: [1 0 0 3 7 8 3 1 4 0 7 3 8 9 1 8 0 1 7 8]
[2023-10-04 19:47:47,970][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:47:47,990][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:47:48,017][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:47:48,045][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:47:48,065][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:47:48,093][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:47:48,121][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:47:48,142][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:47:48,168][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:47:48,189][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:47:48,293][root][INFO] - Class sequence: [8 2 8 9 5 7 0 2 4 3 6 8 8 2 0 4 7 8 4 3]
[2023-10-04 19:47:48,310][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:47:48,330][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:47:48,351][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:47:48,378][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:47:48,398][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:47:48,418][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:47:48,444][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:47:48,465][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:47:48,491][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:47:48,517][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:47:48,628][root][INFO] - Class sequence: [9 6 2 4 5 1 7 4 3 6 0 6 0 6 7 1 8 7 6 9]
[2023-10-04 19:47:48,648][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:47:48,671][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:47:48,699][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:47:48,727][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:47:48,751][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:47:48,774][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:47:48,801][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:47:48,828][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:47:48,855][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:47:48,883][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:47:48,992][root][INFO] - Class sequence: [7 1 8 9 2 9 8 2 7 6 1 8 9 7 3 0 9 2 1 6]
[2023-10-04 19:47:49,010][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:47:49,030][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:47:49,055][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:47:49,081][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:47:49,113][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:47:49,193][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:47:49,213][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:47:49,239][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:47:49,265][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:47:49,290][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:47:49,393][root][INFO] - Class sequence: [6 8 1 2 0 2 5 0 7 5 4 5 3 4 7 8 6 4 9 5]
[2023-10-04 19:47:49,410][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:47:49,429][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:47:49,456][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:47:49,477][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:47:49,496][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:47:49,522][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:47:49,542][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:47:49,568][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:47:49,588][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:47:49,608][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_nocomponents.NoComponentsER'>
[2023-10-04 19:47:49,639][root][INFO] - No. gpus per agent: 0.25
2023-10-04 19:47:52,057	INFO worker.py:1544 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8266 [39m[22m
[2m[36m(ParallelAgent pid=2086422)[0m INFO:root:Agent: node_id: 0, seed: 6
[2m[36m(ParallelAgent pid=2086424)[0m INFO:root:Agent: node_id: 2, seed: 2006
[2m[36m(ParallelAgent pid=2086425)[0m INFO:root:Agent: node_id: 3, seed: 3006
[2m[36m(ParallelAgent pid=2086423)[0m INFO:root:Agent: node_id: 1, seed: 1006
[2m[36m(ParallelAgent pid=2086426)[0m INFO:root:Agent: node_id: 4, seed: 4006
[2m[36m(ParallelAgent pid=2086549)[0m INFO:root:Agent: node_id: 5, seed: 5006
[2m[36m(ParallelAgent pid=2086677)[0m INFO:root:Agent: node_id: 6, seed: 6006
[2m[36m(ParallelAgent pid=2086794)[0m INFO:root:Agent: node_id: 7, seed: 7006
[2023-10-04 19:48:10,827][root][INFO] - Created fleet with 8 agents
[2023-10-04 19:48:10,827][root][INFO] - Adding neighbors...
[2023-10-04 19:48:10,836][root][INFO] - Fleet initialized
Error executing job with overrides: ['algo=monolithic', 'agent.batch_size=64', 'seed=6', 'parallel=True', 'num_agents=8', 'dataset=fashionmnist', 'dataset.num_trains_per_class=64', 'dataset.num_vals_per_class=50', 'dataset.remap_labels=True', 'dataset.with_replacement=True', 'dataset.num_tasks=10', 'net=mlp', 'net.depth=4', 'num_init_tasks=4', 'net.dropout=0.0', 'train.num_epochs=100', 'train.component_update_freq=100', 'train.init_num_epochs=100', 'train.init_component_update_freq=100', 'train.save_freq=20', 'agent.use_contrastive=True', 'agent.memory_size=32', 'root_save_dir=experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'train=monolithic', 'job_name=fashionmnist_monolithic_numtrain_64_contrastive']
Traceback (most recent call last):
  File "/home/vlongle/learning-hive/experiments/run.py", line 41, in main
    fleet.train_and_comm(task_id)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 274, in train_and_comm
    ray.get([agent.train.remote(task_id, start_epoch, self.comm_freq) for agent in self.agents])
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/worker.py", line 2380, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(AttributeError): [36mray::ParallelAgent.train()[39m (pid=2086425, ip=192.168.141.63, repr=<shell.fleet.fleet.ParallelAgent object at 0x7fbfc7d82b60>)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 97, in train
    self.agent.train(trainloader, task_id, testloaders=testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/er_nocomponents.py", line 36, in train
    self.save_data(start_epoch, task_id, testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 226, in save_data
    self.test_loss, self.test_acc = self.evaluate(testloaders, mode=mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 198, in evaluate
    l += self.compute_loss(X, Y, task, mode='ce').item()
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 140, in compute_loss
    return self.compute_cross_entropy_loss(X, Y, task_id, detach=False)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 109, in compute_cross_entropy_loss
    X_encode = self.net.encodev2(X, task_id)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'MLP' object has no attribute 'encodev2'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
{'train': {'component_update_freq': 100, 'num_epochs': 100, 'init_component_update_freq': 100, 'init_num_epochs': 100, 'save_freq': 20}, 'dataset': {'dataset_name': 'fashionmnist', 'num_tasks': 10, 'num_classes_per_task': 2, 'with_replacement': True, 'num_trains_per_class': 64, 'num_vals_per_class': 50, 'remap_labels': True}, 'net': {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0}, 'sharing_strategy': {'name': 'no_sharing', 'num_coms_per_round': 0}, 'seed': 6, 'algo': 'modular', 'job_name': 'fashionmnist_modular_numtrain_64_contrastive', 'num_agents': 8, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'parallel': True, 'num_init_tasks': 4, 'agent': {'save_dir': '${root_save_dir}/${job_name}/${dataset.dataset_name}/${algo}/seed_${seed}', 'batch_size': 64, 'memory_size': 32, 'improvement_threshold': 0.05, 'use_contrastive': True}}
[2023-10-04 19:48:23,083][root][INFO] - Class sequence: [2 3 4 8 8 7 6 9 2 9 1 8 8 7 8 7 4 7 0 2]
[2023-10-04 19:48:23,102][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:48:23,131][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:48:23,159][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:48:23,180][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:48:23,201][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:48:23,220][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:48:23,240][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:48:23,260][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:48:23,281][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:48:23,302][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:48:23,413][root][INFO] - Class sequence: [9 4 5 4 5 3 1 3 5 8 3 1 0 7 4 0 3 1 7 6]
[2023-10-04 19:48:23,432][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:48:23,453][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:48:23,481][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:48:23,502][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:48:23,523][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:48:23,545][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:48:23,572][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:48:23,600][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:48:23,624][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:48:23,653][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:48:23,776][root][INFO] - Class sequence: [8 9 9 8 3 7 1 9 5 0 8 6 6 9 5 7 1 8 0 4]
[2023-10-04 19:48:23,795][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:48:23,815][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:48:23,843][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:48:23,873][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:48:23,895][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:48:23,921][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:48:23,948][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:48:23,970][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:48:23,991][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:48:24,011][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:48:24,114][root][INFO] - Class sequence: [1 0 0 3 7 8 3 1 4 0 7 3 8 9 1 8 0 1 7 8]
[2023-10-04 19:48:24,132][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:48:24,153][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:48:24,180][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:48:24,206][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:48:24,231][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:48:24,259][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:48:24,285][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:48:24,312][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:48:24,339][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:48:24,359][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:48:24,464][root][INFO] - Class sequence: [8 2 8 9 5 7 0 2 4 3 6 8 8 2 0 4 7 8 4 3]
[2023-10-04 19:48:24,481][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:48:24,507][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:48:24,527][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:48:24,548][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:48:24,574][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:48:24,600][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:48:24,627][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:48:24,648][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:48:24,667][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:48:24,687][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:48:24,798][root][INFO] - Class sequence: [9 6 2 4 5 1 7 4 3 6 0 6 0 6 7 1 8 7 6 9]
[2023-10-04 19:48:24,816][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:48:24,836][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:48:24,863][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:48:24,891][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:48:24,912][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:48:24,938][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:48:24,959][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:48:25,049][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:48:25,069][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:48:25,096][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:48:25,204][root][INFO] - Class sequence: [7 1 8 9 2 9 8 2 7 6 1 8 9 7 3 0 9 2 1 6]
[2023-10-04 19:48:25,222][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:48:25,243][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:48:25,262][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:48:25,289][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:48:25,309][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:48:25,330][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:48:25,351][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:48:25,378][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:48:25,399][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:48:25,421][root][INFO] - task 9 :(128, 1, 28, 28)
[2023-10-04 19:48:25,526][root][INFO] - Class sequence: [6 8 1 2 0 2 5 0 7 5 4 5 3 4 7 8 6 4 9 5]
[2023-10-04 19:48:25,544][root][INFO] - task 0 :(128, 1, 28, 28)
[2023-10-04 19:48:25,564][root][INFO] - task 1 :(128, 1, 28, 28)
[2023-10-04 19:48:25,584][root][INFO] - task 2 :(128, 1, 28, 28)
[2023-10-04 19:48:25,604][root][INFO] - task 3 :(128, 1, 28, 28)
[2023-10-04 19:48:25,624][root][INFO] - task 4 :(128, 1, 28, 28)
[2023-10-04 19:48:25,643][root][INFO] - task 5 :(128, 1, 28, 28)
[2023-10-04 19:48:25,676][root][INFO] - task 6 :(128, 1, 28, 28)
[2023-10-04 19:48:25,697][root][INFO] - task 7 :(128, 1, 28, 28)
[2023-10-04 19:48:25,716][root][INFO] - task 8 :(128, 1, 28, 28)
[2023-10-04 19:48:25,737][root][INFO] - task 9 :(128, 1, 28, 28)
i_size 28
num_classes 2
net_cfg {'name': 'mlp', 'depth': 4, 'layer_size': 64, 'dropout': 0.0, 'i_size': 28, 'num_classes': 2, 'num_tasks': 10, 'num_init_tasks': 4, 'use_contrastive': True}
<class 'shell.learners.er_dynamic.CompositionalDynamicER'>
[2023-10-04 19:48:25,761][root][INFO] - No. gpus per agent: 0.25
2023-10-04 19:48:28,157	INFO worker.py:1544 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8266 [39m[22m
[2m[36m(ParallelAgent pid=2166028)[0m INFO:root:Agent: node_id: 0, seed: 6
[2m[36m(ParallelAgent pid=2166112)[0m INFO:root:Agent: node_id: 2, seed: 2006
[2m[36m(ParallelAgent pid=2166029)[0m INFO:root:Agent: node_id: 1, seed: 1006
[2m[36m(ParallelAgent pid=2166113)[0m INFO:root:Agent: node_id: 3, seed: 3006
[2m[36m(ParallelAgent pid=2166173)[0m INFO:root:Agent: node_id: 4, seed: 4006
[2m[36m(ParallelAgent pid=2166238)[0m INFO:root:Agent: node_id: 5, seed: 5006
[2m[36m(ParallelAgent pid=2166497)[0m INFO:root:Agent: node_id: 7, seed: 7006
[2m[36m(ParallelAgent pid=2166429)[0m INFO:root:Agent: node_id: 6, seed: 6006
[2023-10-04 19:48:46,351][root][INFO] - Created fleet with 8 agents
[2023-10-04 19:48:46,352][root][INFO] - Adding neighbors...
[2023-10-04 19:48:46,360][root][INFO] - Fleet initialized
Error executing job with overrides: ['algo=modular', 'agent.batch_size=64', 'seed=6', 'parallel=True', 'num_agents=8', 'dataset=fashionmnist', 'dataset.num_trains_per_class=64', 'dataset.num_vals_per_class=50', 'dataset.remap_labels=True', 'dataset.with_replacement=True', 'dataset.num_tasks=10', 'net=mlp', 'net.depth=4', 'num_init_tasks=4', 'net.dropout=0.0', 'train.num_epochs=100', 'train.component_update_freq=100', 'train.init_num_epochs=100', 'train.init_component_update_freq=100', 'train.save_freq=20', 'agent.use_contrastive=True', 'agent.memory_size=32', 'root_save_dir=experiment_results/vanilla_fix_bug_compute_loss_encodev2', 'train=modular', 'job_name=fashionmnist_modular_numtrain_64_contrastive']
Traceback (most recent call last):
  File "/home/vlongle/learning-hive/experiments/run.py", line 41, in main
    fleet.train_and_comm(task_id)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 274, in train_and_comm
    ray.get([agent.train.remote(task_id, start_epoch, self.comm_freq) for agent in self.agents])
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/ray/_private/worker.py", line 2380, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(AttributeError): [36mray::ParallelAgent.train()[39m (pid=2166029, ip=192.168.141.63, repr=<shell.fleet.fleet.ParallelAgent object at 0x7ef7e1aa6b60>)
  File "/home/vlongle/learning-hive/src/shell/fleet/fleet.py", line 97, in train
    self.agent.train(trainloader, task_id, testloaders=testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 293, in train
    self.save_data(start_epoch, task_id, testloaders, mode=train_mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 515, in save_data
    super().save_data(epoch, task_id, testloaders,
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 226, in save_data
    self.test_loss, self.test_acc = self.evaluate(testloaders, mode=mode)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 477, in evaluate
    l += self.compute_loss(X, Y, task, mode='ce').item()
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 140, in compute_loss
    return self.compute_cross_entropy_loss(X, Y, task_id, detach=False)
  File "/home/vlongle/learning-hive/src/shell/learners/base_learning_classes.py", line 109, in compute_cross_entropy_loss
    X_encode = self.net.encodev2(X, task_id)
  File "/mnt/kostas-graid/sw/envs/vlongle/miniconda3/envs/shell/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'MLPSoftLLDynamic' object has no attribute 'encodev2'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
{'algo': ['monolithic', 'modular'], 'agent.batch_size': 64, 'seed': 6, 'parallel': True, 'num_agents': 8, 'dataset': 'fashionmnist', 'dataset.num_trains_per_class': 64, 'dataset.num_vals_per_class': 50, 'dataset.remap_labels': True, 'dataset.with_replacement': True, 'dataset.num_tasks': 10, 'net': 'mlp', 'net.depth': 4, 'num_init_tasks': 4, 'net.dropout': 0.0, 'train.num_epochs': 100, 'train.component_update_freq': 100, 'train.init_num_epochs': 100, 'train.init_component_update_freq': 100, 'train.save_freq': 20, 'agent.use_contrastive': True, 'agent.memory_size': 32, 'root_save_dir': 'experiment_results/vanilla_fix_bug_compute_loss_encodev2'}
No. of experiments: 2
Experiment runs took 0:01:10.348904
